<!-- ================== reponse.html ================== -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Validation stricte</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
<h2 id="resultat"></h2>
<p id="message"></p>
<a id="btnSuivante" class="btn" href="#" style="display:none;">Ã‰tape suivante</a>
<button id="retourBtn" class="btn" style="display:none;">ğŸ”™ Retour Ã  l'Ã©tape</button>
</div>


<script src="data.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
const params = new URLSearchParams(window.location.search);
const etapeId = parseInt(params.get("etape"), 10);
const token = params.get("token");


let etapeMax = parseInt(localStorage.getItem("etape_max") || "1", 10);


const resultat = document.getElementById("resultat");
const message = document.getElementById("message");
const btnSuivante = document.getElementById("btnSuivante");
const retourBtn = document.getElementById("retourBtn");


retourBtn.addEventListener("click", () => {
window.history.back();
});


// VÃ©rification stricte : l'Ã©tape doit Ãªtre exactement l'Ã©tape actuelle
if (!etapes[etapeId]) {
resultat.innerText = "â›” Ã‰tape inconnue";
message.innerText = "Cette Ã©tape n'existe pas.";
retourBtn.style.display = "inline-block";
} else if (etapeId !== etapeMax) {
resultat.innerText = "â›” QR non valide";
message.innerText = `Tu dois rÃ©soudre l'Ã©tape ${etapeMax} avant.`;
retourBtn.style.display = "inline-block";
} else if (token !== etapes[etapeId].token) {
resultat.innerText = "â›” QR non valide";
message.innerText = "Ce QR ne correspond pas Ã  la bonne Ã©tape.";
retourBtn.style.display = "inline-block";
} else {
// Bonne rÃ©ponse pour l'Ã©tape actuelle
if (etapes[etapeId].suivante) {
etapeMax = etapes[etapeId].suivante;
localStorage.setItem("etape_max", etapeMax.toString());
resultat.innerText = "âœ… Bonne rÃ©ponse !";
message.innerText = "Tu peux passer Ã  l'Ã©tape suivante.";
btnSuivante.href = `etape.html?id=${etapeMax}`;
btnSuivante.style.display = "inline-block";
} else {
resultat.innerText = "ğŸ‰ FÃ©licitations !";
message.innerText = "Tu as terminÃ© le jeu.";
}
}
});
</script>
</body>
</html>